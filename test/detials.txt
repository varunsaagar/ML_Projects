flowchart TD
    A[Customer Call] --> B[Multimodal Input Processing]
    B --> C[Expert Panel Selection]
    C --> D[Collaborative Issue Analysis]
    D --> E[Intelligent Routing Decision]
    E --> F[Agent Assignment]
    F --> G[Outcome & Feedback]
    G -.->|Continuous Learning Loop| C
    
    subgraph "Multimodal Input Processing"
        B1[Audio Analysis] 
        B2[Text Transcription]
        B3[Customer Context]
        B4[Feature Extraction]
    end
    
    subgraph "Expert Panel Selection"
        C1[Router Network]
        C2[Product Key Retrieval]
        C3[Panel Formation]
    end
    
    subgraph "Collaborative Issue Analysis"
        D1[Expert 1 Assessment]
        D2[Expert 2 Assessment]
        D3[Expert 3 Assessment]
        D4[Information Sharing]
        D5[Refined Analysis]
    end
    
    subgraph "Intelligent Routing Decision"
        E1[Fusion Layer]
        E2[Decision Rules]
        E3[Final Routing]
    end
    
    subgraph "Agent Assignment"
        F1[Skill Matching]
        F2[Issue Context Transfer]
        F3[Priority Handling]
    end
    
    subgraph "Outcome & Feedback"
        G1[Resolution Tracking]
        G2[Customer Satisfaction]
        G3[System Optimization]
    end

_________________________
flowchart TD
    A[Customer Call] --> B[Call Intake & Analysis]
    B --> C[Multimodal Feature Extraction]
    C --> D[Expert Panel Selection]
    D --> E[Issue Analysis & Routing Decision]
    E --> F[Agent Assignment]
    F --> G[Call Handling & Resolution]
    G --> H[Outcome Analysis]
    H -.->|Feedback Loop| C
    
    subgraph "Call Intake & Analysis"
        B1[Voice Recording] --> B2[Speech-to-Text]
        B1 --> B3[Audio Feature Analysis]
        B2 --> B4[Text Analysis]
        B3 --> B5[Sentiment/Urgency Detection]
    end
    
    subgraph "Multimodal Feature Extraction"
        C1[Text Features] 
        C2[Audio Features]
        C3[Customer History]
        C4[Environmental Parameters]
    end
    
    subgraph "Expert Panel Selection"
        D1[Router Network]
        D2[Expert Panel Formation]
        D3[Specialized Expert Selection]
    end
    
    subgraph "Issue Analysis & Routing Decision"
        E1[Expert 1 Analysis]
        E2[Expert 2 Analysis]
        E3[Expert 3 Analysis]
        E4[Aggregation of Expert Opinions]
        E5[Final Routing Decision]
    end
    
    subgraph "Agent Assignment"
        F1[Agent Skill Matching]
        F2[Workload Balancing]
        F3[Priority Queue Assignment]
    end
    
    subgraph "Call Handling & Resolution"
        G1[Agent Intervention]
        G2[Issue Resolution]
        G3[Upselling/Cross-Selling Opportunities]
    end
    
    subgraph "Outcome Analysis"
        H1[Resolution Success]
        H2[Customer Satisfaction]
        H3[Call Duration]
        H4[Agent Performance]
    end




----
flowchart TD
    subgraph Input["Input Processing"]
        A[Raw Audio] --> F1[Audio Feature Extraction]
        B[Environment Parameters] --> F4[Environment Embedding]
    end

    subgraph Router["Router Network"]
        R[Router Network - RL Policy] --> RG[Query Generation]
        RG --> PK[Product Key Retrieval]
        PK -->|Probabilistic Selection| E1[Expert 1]
        PK -->|Probabilistic Selection| E2[Expert 2]
        PK -->|Probabilistic Selection| E3[Expert P]
    end

    subgraph ExpertProcessing["Expert Panel Processing"]
        E1 --> O1[Expert Output - Reasoning]
        E2 --> O2[Expert Output - Reasoning]
        E3 --> O3[Expert Output - Reasoning]
        
        O1 --> AG[Aggregation Round 1]
        O2 --> AG
        O3 --> AG
        
        AG -->|Aggregated Output| CON[Contextualized Input]
        
        subgraph Round2["Round 2 (optional)"]
            CON --> E1R[Expert 1 Refined - Reasoning]
            CON --> E2R[Expert 2 Refined - Reasoning]
            CON --> E3R[Expert P Refined - Reasoning]
        end
        
        E1R --> OF1[Expert Output Final]
        E2R --> OF2[Expert Output Final]
        E3R --> OF3[Expert Output Final]
    end

    subgraph Fusion["Fusion Layer (RL - Value Network)"]
        OF1 --> FU[Fusion/Aggregation - RL Policy/Value]
        OF2 --> FU
        OF3 --> FU
        FU --> RD[Final Routing Decision]
    end

    F1 --> R
    F4 --> R

    RD --> Output[Route Call]
    Output -- Reward --> R
    Output -- Reward --> FU

    classDef rl fill:#ff9999,stroke:#ff0000,color:#000000
    classDef policy fill:#99ff99,stroke:#00ff00,color:#000000
    classDef value fill:#9999ff,stroke:#0000ff,color:#000000
    
    class R,PK rl
    class E1,E2,E3,E1R,E2R,E3R policy
    class FU value
